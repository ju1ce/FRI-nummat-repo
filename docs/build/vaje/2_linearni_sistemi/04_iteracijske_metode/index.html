<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Iteracijske metode · Numerična matematika na FRI</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Numerična matematika na FRI</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Domov</a></li><li><span class="tocitem">Uvod</span><ul><li><a class="tocitem" href="../../1_uvod/01_koren/">Računanje kvadratnega korena</a></li><li><a class="tocitem" href="../../1_uvod/02_pi/">Računanje števila <span>$\pi$</span></a></li></ul></li><li><span class="tocitem">Linearni sistemi</span><ul><li><a class="tocitem" href="../02_tridiagonalni_sistemi/">Tridiagonalni sistemi</a></li><li><a class="tocitem" href="../03_minimalne_ploskve/">Minimalne ploskve (Laplaceova enačba)</a></li><li class="is-active"><a class="tocitem" href>Iteracijske metode</a><ul class="internal"><li><a class="tocitem" href="#Primer"><span>Primer</span></a></li><li><a class="tocitem" href="#Konvergenca"><span>Konvergenca</span></a></li><li><a class="tocitem" href="#Metoda-konjugiranih-gradientov"><span>Metoda konjugiranih gradientov</span></a></li><li><a class="tocitem" href="#Koda"><span>Koda</span></a></li></ul></li><li><a class="tocitem" href="../05_implicitne_ploskve/">Interpolacija z implicitnimi funkcijami</a></li></ul></li><li><span class="tocitem">Lastne vrednosti</span><ul><li><a class="tocitem" href="../../3_lastne_vrednosti/06_konj/">Konj na šahovnici</a></li><li><a class="tocitem" href="../../3_lastne_vrednosti/06_spektralno_grucenje/">Spektralno razvrščanje v gruče</a></li></ul></li><li><span class="tocitem">Nelinearne enačbe</span><ul><li><a class="tocitem" href="../../4_nelinearne_enacbe/01_konvergenca/">Konvergenčna območja iteracijskih metod</a></li><li><a class="tocitem" href="../../4_nelinearne_enacbe/02_razdalja/">Nelinearne enačbe in geometrija</a></li></ul></li><li><span class="tocitem">Interpolacija, aproksimacija</span><ul><li><a class="tocitem" href="../../5_interpolacija/07_zlepki/">Interpolacija z zlepki</a></li><li><a class="tocitem" href="../../6_aproksimacija/co2/">Aproksimacija z linearnim modelom</a></li><li><a class="tocitem" href="../../6_aproksimacija/08_chebfun/">Aproksimacija s polinomi Čebiševa</a></li></ul></li><li><span class="tocitem">Integral</span><ul><li><a class="tocitem" href="../../7_integral/10_quad/">Integrali</a></li><li><a class="tocitem" href="../../7_integral/11_quadnD/">Večrazsežni integrali</a></li></ul></li><li><span class="tocitem">Odvod</span><ul><li><a class="tocitem" href="../../8_odvod/12_autodiff/">Automatsko odvajanje</a></li></ul></li><li><span class="tocitem">Diferencialne enačbe</span><ul><li><a class="tocitem" href="../../9_nde/13_lotka_volterra/">Populacijska dinamika</a></li><li><a class="tocitem" href="../../9_nde/14_perioda/">Perioda geostacionarne orbite</a></li></ul></li><li><span class="tocitem">Domače naloge</span><ul><li><a class="tocitem" href="../../../domace/1_domaca/">1. domača naloga</a></li><li><a class="tocitem" href="../../../domace/2_domaca/">2. domača naloga</a></li><li><a class="tocitem" href="../../../domace/3_domaca/">3. domača naloga</a></li><li><a class="tocitem" href="../../../domace/4_domaca/">4. domača naloga</a></li><li><a class="tocitem" href="../../../contributing/">Kako sodelovati pri predmetu Numerična matematika</a></li><li><a class="tocitem" href="../../../workflow/">Developer documentation</a></li></ul></li><li><span class="tocitem">Knjižnica</span><ul><li><a class="tocitem" href="../../../lib/public/">Vidne funkcije</a></li><li><a class="tocitem" href="../../../lib/internals/">Skrite funkcije</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Linearni sistemi</a></li><li class="is-active"><a href>Iteracijske metode</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Iteracijske metode</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://gitlab.com/nummat/vaje-nummat/blob/master/docs/src/vaje/2_linearni_sistemi/04_iteracijske_metode.md#" title="Edit on GitLab"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitLab</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Iteracijske-metode"><a class="docs-heading-anchor" href="#Iteracijske-metode">Iteracijske metode</a><a id="Iteracijske-metode-1"></a><a class="docs-heading-anchor-permalink" href="#Iteracijske-metode" title="Permalink"></a></h1><p>V <a href="../03_minimalne_ploskve/">nalogi o minimalnih ploskvah</a> smo reševali linearen sistem enačb</p><p class="math-container">\[u_{i,j-1}+u_{i-1,j}-4u_{ij}+u_{i+1,j}+u_{i,j+1}=0\]</p><p>za elemente matrike <span>$U=[u_{ij}]$</span>, ki predstavlja višinske vrednosti na minimalni ploskvi v vozliščih kvadratne mreže. Največ težav smo imeli z zapisom matrike sistema in desnih strani. Poleg tega je matrika sistema <span>$L$</span> razpršena (ima veliko ničel), ko izvedemo LU razcep ali Gaussovo eliminacijo, veliko teh ničelnih elementov postane neničelni in matrika se napolni. Pri razpršenih matrikah tako pogosto uporabimo <a href="https://en.wikipedia.org/wiki/Iterative_method#Linear_systems">iterativne metode</a> za reševanje sistemov enačb, pri katerih matrika ostane razpršena in tako lahko prihranimo veliko na prostorski in časovni zahtevnosti.</p><div class="admonition is-info"><header class="admonition-header">Ideja iteracijskih metod je preprosta</header><div class="admonition-body"><p>Enačbe preuredimo tako, da ostane na eni strani le en element s koeficientom 1. Tako dobimo iteracijsko formulo za zaporedje približkov <span>$u_{ij}^{(k)}$</span>. Limita rekurzivnega zaporedja je ena od fiksnih točk rekurzivne enačbo, če zaporedje konvergira. Ker smo rekurzivno enačbo izpeljali iz originalnih enačb, je njena fiksna točka ravno rešitev originalnega sistema.</p></div></div><p>V primeru enačb za laplaceovo enačbo(minimalne ploskve), tako dobimo rekurzivne enačbe</p><p class="math-container">\[u_{ij}^{(k+1)} = \frac{1}{4}\left(u_{i,j-1}^{(k)}+u_{i-1,j}^{(k)}+u_{i+1,j}^{(k)}+u_{i,j+1}^{(k)}\right),\]</p><p>ki ustrezajo <a href="https://en.wikipedia.org/wiki/Jacobi_method">jacobijevi iteraciji</a></p><div class="admonition is-success"><header class="admonition-header">Pogoji konvergence</header><div class="admonition-body"><p>Rekli boste, to je preveč enostavno, če enačbe le pruredimo in se potem rešitel kar sama pojavi, če le dovolj dolgo računamo. Gotovo se nekje skriva kak hakelc. Res je! Težave se pojavijo, če zaporedje približkov <strong>ne konvergira dovolj hitro</strong> ali pa sploh ne. Jakobijeva, Gauss-Seidlova in SOR iteracija <strong>ne konvergirajo vedno</strong>, zagotovo pa konvergirajo, če je matrika po vrsticah <a href="https://sl.wikipedia.org/wiki/Diagonalno_dominantna_matrika">diagonalno dominantna</a>.</p></div></div><p>Konvergenco jacobijeve iteracije lahko izboljšamo, če namesto vrednosti na prejšnjem približku, uporabimo nove vrednosti, ki so bile že izračunani. Če računamo element <span>$u_{ij}$</span> po leksikografskem vrstnem redu, bodo elementi <span>$u_{il}^{(k+1)}$</span> za <span>$l &lt; j$</span> in <span>$u_{lj}^{(k+1)}$</span> za <span>$l &lt; i$</span> že na novo izračunani, ko računamo <span>$u_{ij}^{(k+1)}$</span>. Če jih upobimo  v iteracijski formuli, dobimo <a href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method">gauss-seidlovo iteracijo</a></p><p class="math-container">\[u_{ij}^{(k+1)} = \frac{1}{4}\left(u_{i,j-1}^{(k+1)}+u_{i-1,j}^{(k)}+u_{i+1,j}^{(k)}+u_{i,j+1}^{(k)}\right),\]</p><p>Konvergenco še izboljšamo, če približek <span>$u_{ij}^{(k+1)}$</span>, ki ga dobimo z gauss-seidlovo metodo, malce zmešamo s približkom na prejšnjem koraku <span>$u_{ij}^{(k)}$</span></p><p class="math-container">\[u_{ij}^{(k+1)} = (1-\omega)u_{ij}^{(k)} + \omega\frac{1}{4}\left(u_{i,j-1}^{(k+1)}+
u_{i-1,j}^{(k)}+u_{i+1,j}^{(k)}+u_{i,j+1}^{(k)}\right),\]</p><p>in dobimo <a href="https://en.wikipedia.org/wiki/Successive_over-relaxation">metodo SOR</a>. Parameter <span>$\omega$</span> je lahko poljubno število <span>$(0,2]$</span> Pri <span>$\omega=1$</span> dobimo gauss-seidlovo iteracijo.</p><h2 id="Primer"><a class="docs-heading-anchor" href="#Primer">Primer</a><a id="Primer-1"></a><a class="docs-heading-anchor-permalink" href="#Primer" title="Permalink"></a></h2><pre><code class="language-julia">using Plots
U0 = zeros(20, 20)
x = LinRange(0, pi, 20)
U0[1,:] = sin.(x)
U0[end,:] = sin.(x)
surface(x, x, U0, title=&quot;Začetni približek za iteracijo&quot;)
savefig(&quot;zacetni_priblizek.png&quot;)</code></pre><p><img src="../zacetni_priblizek.png" alt="začetni priblizek za iteracijo"/></p><pre><code class="language-julia">L = LaplaceovOperator(2)
U = copy(U0)
animation = Animation()
for i=1:200
    U = korak_sor(L, U)
    surface(x, x, U, title=&quot;Konvergenca Gauss-Seidlove iteracije&quot;)
    frame(animation)
end
mp4(animation, &quot;konvergenca.mp4&quot;, fps = 10)</code></pre><video width="600" height="400" controls>
<source src="../konvergenca.mp4" type="video/mp4">
<source src="konvergenca.mp4" type="video/mp4">
</video><p><a href="../konvergenca.mp4">Konvergenca Gauss-Seidlove iteracije</a></p><h2 id="Konvergenca"><a class="docs-heading-anchor" href="#Konvergenca">Konvergenca</a><a id="Konvergenca-1"></a><a class="docs-heading-anchor-permalink" href="#Konvergenca" title="Permalink"></a></h2><p>Grafično predstavi konvergenco v odvisnoti od izbire <span>$\omega$</span>.</p><pre><code class="language-julia">using Plots
n = 50
U = zeros(n,n)
U[:,1] = sin.(LinRange(0, pi, n))
U[:, end] = U[:, 1]
L = LaplaceovOperator(2)
omega = LinRange(0.1, 1.95, 40)
it = [iteracija(x-&gt;korak_sor(L, x, om), U; tol=1e-3)[2] for om in omega]
plot(omega, it, title = &quot;Konvergenca SOR v odvisnosti od omega&quot;)
savefig(&quot;sor_konvergenca.svg&quot;)</code></pre><p><img src="../sor_konvergenca.svg" alt="Konvergenca SOR v odvisnosti od omega"/></p><h2 id="Metoda-konjugiranih-gradientov"><a class="docs-heading-anchor" href="#Metoda-konjugiranih-gradientov">Metoda konjugiranih gradientov</a><a id="Metoda-konjugiranih-gradientov-1"></a><a class="docs-heading-anchor-permalink" href="#Metoda-konjugiranih-gradientov" title="Permalink"></a></h2><p>Ker je laplaceova matrika diagonalno dominantna z <span>$-4$</span> na diagonali je negativno definitna. Zato lahko uporabimo <a href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">metodo konjugiranih gradientov</a>. Algoritem konjugiranih gradientov potrebuje le množenje z laplaceovo matriko, ne pa tudi samih elementov. Zato lahko izkoristimo možnosti, ki jih ponuja programski jezik <code>julia</code>, da lahko za <a href="https://docs.julialang.org/en/v1.0/manual/methods/">isto funkcijo napišemo različne metode za različne tipe argumentov</a>. </p><p>Preprosto napišemo novo metodo za množenje <a href="#Base.:*-Tuple{LaplaceovOperator{2}, Matrix}"><code>*</code></a>, ki sprejme argumente tipa <a href="../03_minimalne_ploskve/#NumMat.LaplaceovOperator"><code>LaplaceovOperator{2}</code></a> in <code>Matrix</code>. Metoda konjugiranih gradientov še hitreje konvergira kot SOR.</p><pre><code class="language-julia">using NumMat
n = 50
U = zeros(n,n)
U[:,1] = sin.(LinRange(0, pi, n))
U[:, end] = U[:, 1]
L = LaplaceovOperator{2}()
b = desne_strani(L, U)
Z, it = conjgrad(L, b, zeros(n, n))
println(&quot;Število korakov: $it&quot;)</code></pre><pre class="documenter-example-output">Število korakov: 34</pre><h2 id="Koda"><a class="docs-heading-anchor" href="#Koda">Koda</a><a id="Koda-1"></a><a class="docs-heading-anchor-permalink" href="#Koda" title="Permalink"></a></h2><ul><li><a href="#Base.:*-Tuple{LaplaceovOperator{2}, Matrix}"><code>Base.:*</code></a></li><li><a href="#NumMat.conjgrad"><code>NumMat.conjgrad</code></a></li><li><a href="#NumMat.desne_strani-Tuple{LaplaceovOperator{2}, Matrix}"><code>NumMat.desne_strani</code></a></li><li><a href="#NumMat.iteracija-Tuple{Any, Any}"><code>NumMat.iteracija</code></a></li><li><a href="#NumMat.korak_sor"><code>NumMat.korak_sor</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Base.:*-Tuple{LaplaceovOperator{2}, Matrix}" href="#Base.:*-Tuple{LaplaceovOperator{2}, Matrix}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">*(L::LaplaceovOperator{2}, X::Matrix)</code></pre><p>množi matriko <code>X</code> z matriko za laplaceov operator.</p><p><strong>Primer</strong></p><pre><code class="language-julia-repl">julia&gt; L = LaplaceovOperator{2}();

julia&gt; L*[1 2 3 4; 5 0 1 6; 7 8 9 10]
3×4 Array{Int64,2}:
 1   2  3   4
 5  -1  4   6
 7   8  9  10</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://gitlab.com/nummat/vaje-nummat/blob/bc8c2bfa0885ef20e11bce0b7341812a1edde41e/src/vaje/2_linearni_sistemi/Laplace2Diter.jl#L6-22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumMat.conjgrad" href="#NumMat.conjgrad"><code>NumMat.conjgrad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">it = conjgrad!(A, b, x; tol=1e-10, maxit=1000)</code></pre><p>metoda konjugiranih gradientov za reševanje sistema enačb </p><p class="math-container">\[Ax =b\]</p><p><strong>Primer</strong></p><pre><code class="language-julia-repl">julia&gt; A = [2 1 0;1 2 1; 0 1 2]; b = ones(3);

julia&gt; x0 = zeros(3);

julia&gt; x, it = conjgrad(A, b, x0)
([-0.5, -1.0, -0.5], 2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://gitlab.com/nummat/vaje-nummat/blob/bc8c2bfa0885ef20e11bce0b7341812a1edde41e/src/vaje/2_linearni_sistemi/Laplace2Diter.jl#L114-131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumMat.desne_strani-Tuple{LaplaceovOperator{2}, Matrix}" href="#NumMat.desne_strani-Tuple{LaplaceovOperator{2}, Matrix}"><code>NumMat.desne_strani</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">b = desne_strani(L::LaplaceovOperator{2}, U::Matrix)</code></pre><p>Izračuna matriko desnih strani za Laplaceovo enačbo v 2D iz začetnih pogojev.</p></div><a class="docs-sourcelink" target="_blank" href="https://gitlab.com/nummat/vaje-nummat/blob/bc8c2bfa0885ef20e11bce0b7341812a1edde41e/src/vaje/2_linearni_sistemi/Laplace2Diter.jl#L34-38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumMat.iteracija-Tuple{Any, Any}" href="#NumMat.iteracija-Tuple{Any, Any}"><code>NumMat.iteracija</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">U = iteracija(korak, U0, robni_indeksi)</code></pre><p>Poišče limito rekurzivnega zaporedja <span>$U_n = korak(U_{n-1})$</span> z začetnim členom <code>U0</code></p><p><strong>Rezultat</strong></p><ul><li><code>U</code> limita zaporedja</li><li><code>it</code> število korakov iteracija</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://gitlab.com/nummat/vaje-nummat/blob/bc8c2bfa0885ef20e11bce0b7341812a1edde41e/src/vaje/2_linearni_sistemi/Laplace2Diter.jl#L88-96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumMat.korak_sor" href="#NumMat.korak_sor"><code>NumMat.korak_sor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">U1 = korak_sor(L, U0, ω = 1, spremeni_indekse = [])</code></pre><p>Izvede en korak SOR iteracije pri reševanju enačb</p><p class="math-container">\[u_{i-1,j}+u_{i,j-1} - 4u_{ij} + u_{i+1,j}+u_{i,j+1} = 0.\]</p><p><strong>Parametri</strong></p><ul><li><code>L::LaplaceovOperator{2}</code>`</li><li><code>U0::Matrix</code> matika vrednosti <span>$u_{ij}$</span></li><li><code>ω::Float</code> relaksacijski parameter <span>$\omega\in[0,2]$</span></li><li><code>spremeni_indekse::Array{Tuple,2}</code> seznam indeksov točk, ki  niso podane kot robni pogoji</li></ul><p><strong>Rezultat</strong></p><ul><li><code>U1::Matrix</code> vrednost matrike <span>$U$</span> na naslednji iteraciji</li></ul><p><strong>Primer</strong></p><pre><code class="language-julia-repl">julia&gt; korak_sor(LaplaceovOperator{2}(), [1. 1 1; 2  0 3; 1 4 1])
3×3 Array{Float64,2}:
 1.0  1.0  1.0
 2.0  2.5  3.0
 1.0  4.0  1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://gitlab.com/nummat/vaje-nummat/blob/bc8c2bfa0885ef20e11bce0b7341812a1edde41e/src/vaje/2_linearni_sistemi/Laplace2Diter.jl#L49-75">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../03_minimalne_ploskve/">« Minimalne ploskve (Laplaceova enačba)</a><a class="docs-footer-nextpage" href="../05_implicitne_ploskve/">Interpolacija z implicitnimi funkcijami »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 1 March 2022 00:29">Tuesday 1 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
